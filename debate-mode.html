<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DebateWorm ‚Äì Debate Mode</title>
  <style>
    :root {
      --primary: #6A2C70;
      --secondary: #B83B5E;
      --accent: #F08A5D;
      --light: #F9ED69;
      --dark: #3D315B;
      --background: #F5F5F5;
      --success: #4CAF50;
      --info: #2196F3;
    }
    
    * {
      box-sizing: border-box;
      transition: all .2s ease;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: var(--background);
      color: var(--dark);
      line-height: 1.6;
    }
    
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 2rem;
    }
    
    h1, h2, h3 {
      margin: 0 0 .5rem 0;
    }
    
    .button {
      background: var(--secondary);
      color: #fff;
      border: none;
      padding: .5rem 1rem;
      border-radius: 5px;
      font-weight: 700;
      cursor: pointer;
    }
    
    .button:hover {
      background: var(--accent);
    }
    
    .button:disabled {
      opacity: .5;
      cursor: not-allowed;
    }
    
    /* Header with navigation */
    header {
      background-color: var(--primary);
      color: white;
      padding: 15px 0;
    }
    
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 2rem;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo-icon {
      background: var(--accent);
      padding: 5px;
      border-radius: 5px;
    }
    
    nav ul {
      display: flex;
      list-style: none;
      gap: 20px;
    }
    
    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
    }
    
    /* Tabs */
    .mode-tabs {
      display: flex;
      margin-bottom: 1.5rem;
      border-bottom: 2px solid var(--primary);
    }
    
    .mode-tab {
      padding: .75rem 1.5rem;
      background: #e0e0e0;
      border-radius: 8px 8px 0 0;
      margin-right: .5rem;
      font-weight: bold;
      cursor: pointer;
      text-decoration: none;
      color: var(--dark);
    }
    
    .mode-tab.active {
      background: var(--primary);
      color: #fff;
    }
    
    /* Debate area with the new layout */
    .debate-container {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    
    .text-panel {
      background: white;
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      height: 100%;
    }
    
    .debate-panel {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .notes-panel {
      background: white;
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      height: 100%;
    }
    
    .prompt-box {
      border: 3px solid #000;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
      background: white;
    }
    
    .timer-display {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin: 20px 0;
    }
    
    .hourglass-icon {
      font-size: 2rem;
    }
    
    .timer-text {
      font-size: 1.2rem;
      font-weight: bold;
    }
    
    .rebuttal-box {
      border: 3px solid #000;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
      background: white;
    }
    
    .debate-players {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-top: 30px;
      position: relative;
    }
    
    .player {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    
    .player-icon {
      font-size: 3rem;
      margin-bottom: 10px;
    }
    
    .worm-icons {
      display: flex;
      justify-content: center;
      position: absolute;
      bottom: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
    }
    
    .worm-icon {
      font-size: 2rem;
      margin: 0 20px;
    }
    
    /* Book selector */
    #bookSelector {
      background: #fff;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,.1);
    }
    
    .book-options {
      display: flex;
      gap: 1rem;
      margin-top: .5rem;
      overflow-x: auto;
      padding-bottom: .5rem;
    }
    
    .book-option {
      min-width: 150px;
      background: var(--background);
      padding: .75rem;
      border-radius: 8px;
      cursor: pointer;
    }
    
    .book-option:hover {
      transform: translateY(-3px);
    }
    
    .book-option.active {
      background: var(--accent);
      color: #fff;
    }
    
    /* For the original debate components */
    #demoCard {
      display: none;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,.1);
      padding: 1.5rem;
      margin-top: 1rem;
    }
    
    .msg {
      padding: .75rem 1rem;
      border-radius: 8px;
      margin: .5rem 0;
      max-width: 90%;
    }
    
    .msg strong {
      display: block;
      margin-bottom: .25rem;
      font-size: .85rem;
    }
    
    .msg .evidence {
      font-style: italic;
      font-size: .9rem;
      margin-top: .5rem;
      padding-top: .5rem;
      border-top: 1px dashed rgba(0,0,0,.1);
    }
    
    .you {
      background: var(--secondary);
      color: #fff;
      margin-left: auto;
    }
    
    .you .evidence {
      border-top: 1px dashed rgba(255,255,255,.3);
    }
    
    .opp {
      background: var(--light);
      color: var(--dark);
    }
    
    .system {
      background: var(--dark);
      color: #fff;
      text-align: center;
      max-width: 100%;
    }
    
    /* Custom for the new layout */
    #messagesNew {
      background: var(--background);
      border-radius: 8px;
      padding: 1rem;
      height: 250px;
      overflow-y: auto;
      margin-bottom: 1rem;
    }
    
    #inputRowNew {
      display: flex;
      gap: .5rem;
      margin-bottom: 1rem;
    }
    
    #inputRowNew input {
      flex: 1;
      padding: .75rem;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }
    
    #aiModeratorPanel {
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--info);
      color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,.1);
    }
    
    #aiModeratorPanel h4 {
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: .5rem;
    }
    
    #scorecards {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .scorecard {
      flex: 1;
      background: rgba(255,255,255,.2);
      border-radius: 8px;
      padding: .75rem;
    }
    
    .scorecard h5 {
      margin: 0 0 .5rem 0;
      font-size: .9rem;
      opacity: .8;
    }
    
    .score {
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .score-comment {
      font-size: .85rem;
      margin-top: .25rem;
    }
    
    .home-link {
      display: inline-block;
      margin-bottom: 15px;
      color: var(--primary);
      text-decoration: none;
      font-weight: bold;
    }
    
    .home-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo">
        <div class="logo-icon">ü™±üìö</div>
        <h1>DebateWorm</h1>
      </div>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="#">Library</a></li>
          <li><a href="#">Leaderboard</a></li>
          <li><a href="#">Profile</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="container">
    <a href="index.html" class="home-link">‚Üê Back to Home</a>
    
    <h1>DebateWorm <span style="font-size:.6em;color:var(--secondary)">Improving Reading Through Meaningful Discussion</span></h1>

    <!-- Tabs -->
    <div class="mode-tabs">
      <a href="debate-mode.html"><div class="mode-tab active">Debate Mode</div></a>
      <a href="reading-mode.html"><div class="mode-tab">Reading Mode</div></a>
      <div class="mode-tab">Story Mode</div>
      <div class="mode-tab">Practice Mode</div>
    </div>

    <!-- Book selector -->
    <div id="bookSelector">
      <h3>Select a Book to Debate</h3>
      <p>Choose a book you've read to start debating topics from it:</p>
      <div class="book-options">
        <div class="book-option active" data-book="mockingbird"><h4>To Kill a Mockingbird</h4><p>Harper Lee</p></div>
        <div class="book-option" data-book="gatsby"><h4>The Great Gatsby</h4><p>F. Scott Fitzgerald</p></div>
        <div class="book-option" data-book="1984"><h4>1984</h4><p>George Orwell</p></div>
        <div class="book-option" data-book="hamlet"><h4>Hamlet</h4><p>William Shakespeare</p></div>
        <div class="book-option" data-book="frankenstein"><h4>Frankenstein</h4><p>Mary Shelley</p></div>
      </div>
      <button id="startDebateBtn" class="button" style="margin-top:1rem">Start Debate</button>
    </div>

    <!-- New Debate Interface (based on the image) -->
    <div id="newDebateInterface" style="display:none;">
      <div class="debate-container">
        <div class="text-panel">
          <h3>Text:</h3>
          <p>"You never really understand a person until you consider things from his point of view‚Ä¶ until you climb inside of his skin and walk around in it."</p>
          <p>"Simply because we were licked a hundred years before we started is no reason for us not to try to win."</p>
          <p>"The one thing that doesn't abide by majority rule is a person's conscience."</p>
        </div>
        
        <div class="debate-panel">
          <div class="prompt-box">
            <h3>Prompt:</h3>
            <p>Create a unique argument about this excerpt from <span id="bookTitle">To Kill a Mockingbird</span>.</p>
          </div>
          
          <div class="timer-display">
            <div class="hourglass-icon">‚åõ</div>
            <div class="timer-text">
              <div>Rebuttal period</div>
              <div id="timerNew">4:59 remaining</div>
            </div>
          </div>
          
          <div class="rebuttal-box">
            <p>Type or speak your rebuttal here.</p>
          </div>
          
          <div id="messagesNew">
            <div class="msg system"><strong>Debate has begun!</strong><p>Support arguments with evidence. 5 minutes remaining.</p></div>
            <div class="msg opp"><strong>LiteraryTitan:</strong> Looking at Maycomb's social context, Atticus had a moral obligation to defend Tom Robinson.<div class="evidence">Evidence: "‚Ä¶a person's conscience."</div></div>
          </div>
          
          <div id="inputRowNew">
            <input id="msgInputNew" type="text" placeholder="Type your argument‚Ä¶">
            <button id="sendBtnNew" class="button">Send</button>
          </div>
          
          <div class="debate-players">
            <div class="player">
              <div class="player-icon">üë§</div>
              <div>Player 1</div>
            </div>
            
            <div class="worm-icons">
              <div class="worm-icon">üêõ</div>
              <div class="worm-icon">ü™±</div>
            </div>
            
            <div class="player">
              <div class="player-icon">üë§</div>
              <div>Player 2</div>
            </div>
          </div>
        </div>
        
        <div class="notes-panel">
          <h3>Notes:</h3>
          <p>Use this space to jot down your thoughts and evidence before responding.</p>
          <textarea style="width: 100%; height: 300px; padding: 10px; margin-top: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
        </div>
      </div>
      
      <div id="aiModeratorPanel">
        <h4>ü§ñ AI Moderator Feedback</h4>
        <p>Waiting for your first argument‚Ä¶</p>
        <div id="scorecards" style="display:none">
          <div class="scorecard">
            <h5>TEXTUAL EVIDENCE</h5>
            <div class="score">--</div>
            <div class="score-comment">Not yet evaluated</div>
          </div>
          <div class="scorecard">
            <h5>ARGUMENT LOGIC</h5>
            <div class="score">--</div>
            <div class="score-comment">Not yet evaluated</div>
          </div>
          <div class="scorecard">
            <h5>RESPONSIVENESS</h5>
            <div class="score">--</div>
            <div class="score-comment">Not yet evaluated</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Original Debate card (hidden by default) -->
    <div id="demoCard" style="display:none">
      <div id="debateHeader">
        <div class="player"><div class="avatar">You</div><div><strong>BookWorm74</strong><br><small>Lvl 12 ¬∑ 345 pts</small></div></div>
        <div id="timer">05:00</div>
        <div class="player"><div><strong>LiteraryTitan</strong><br><small>Lvl 14 ¬∑ 412 pts</small></div><div class="avatar">LT</div></div>
      </div>

      <div id="debateTopic"><h3>Topic: Should Atticus Finch have defended Tom Robinson?</h3><p><em>Book: To Kill a Mockingbird</em></p></div>

      <div id="debateArea">
        <div id="reading"><h4>Key Excerpts from the Text</h4><p>"You never really understand a person until you consider things from his point of view‚Ä¶ until you climb inside of his skin and walk around in it."</p><p>"Simply because we were licked a hundred years before we started is no reason for us not to try to win."</p><p>"The one thing that doesn't abide by majority rule is a person's conscience."</p></div>
        <div id="chatCol">
          <div id="messages"><div class="msg system"><strong>Debate has begun!</strong><p>Support arguments with evidence. 5 minutes remaining.</p></div><div class="msg opp"><strong>LiteraryTitan:</strong> Looking at Maycomb's social context, Atticus had a moral obligation to defend Tom Robinson.<div class="evidence">Evidence: "‚Ä¶a person's conscience."</div></div></div>
          <div id="evidenceRow"><textarea id="evidenceInput" placeholder="Add a quote (optional)‚Ä¶"></textarea></div>
          <div id="inputRow"><input id="msgInput" type="text" placeholder="Type your argument‚Ä¶"><button id="sendBtn" class="button">Send</button></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // DOM Elements
    const startDebateBtn = document.getElementById('startDebateBtn');
    const demoCard = document.getElementById('demoCard');
    const newDebateInterface = document.getElementById('newDebateInterface');
    const bookSelector = document.getElementById('bookSelector');
    const msgInput = document.getElementById('msgInput');
    const msgInputNew = document.getElementById('msgInputNew');
    const evidenceInput = document.getElementById('evidenceInput');
    const sendBtn = document.getElementById('sendBtn');
    const sendBtnNew = document.getElementById('sendBtnNew');
    const messages = document.getElementById('messages');
    const messagesNew = document.getElementById('messagesNew');
    const timerEl = document.getElementById('timer');
    const timerElNew = document.getElementById('timerNew');
    const aiPanel = document.getElementById('aiModeratorPanel');
    const scorecards = document.getElementById('scorecards');
    const bookOptions = document.querySelectorAll('.book-option');
    
    // Book selection
    bookOptions.forEach(option => {
      option.addEventListener('click', () => {
        bookOptions.forEach(o => o.classList.remove('active'));
        option.classList.add('active');
        
        // Update book title in the prompt
        const bookTitle = option.querySelector('h4').textContent;
        document.getElementById('bookTitle').textContent = bookTitle;
      });
    });
    
    // Constants
    const opponentLines = [
      {text: "Your point about family safety is valid, but remember Atticus's conscience.", evidence: "\"‚Ä¶a person's conscience.\""},
      {text: "Atticus knew the case was unwinnable yet still took it.", evidence: "\"‚Ä¶we were licked a hundred years‚Ä¶\""},
      {text: "He couldn't teach his children integrity if he didn't demonstrate it.", evidence: "\"If I didn't I couldn't hold up my head‚Ä¶\""},
      {text: "Personal integrity trumps public opinion or even family hardship.", evidence: "\"Before I can live with other folks I've got to live with myself.\""}
    ];
    
    const moderatorFeedback = [
      "Good point! Consider linking to moral courage.",
      "Interesting perspective. Reference Atticus's motivations.",
      "Compelling argument‚Äîtie to conscience rule.",
      "Well reasoned! Context adds depth."
    ];
    
    // Timer variables
    let timeLeft = 300; // Changed to 5 minutes (300 seconds)
    let ticking;
    let messageCount = 0;
    let debateEnded = false;
    
    // Start debate
    startDebateBtn.addEventListener('click', () => {
      bookSelector.style.display = 'none';
      // Show the new interface instead of the old one
      newDebateInterface.style.display = 'block';
      //demoCard.style.display = 'block';
      
      msgInputNew.focus();
      ticking = setInterval(updateTimer, 1000);
      
      setTimeout(() => {
        scorecards.style.display = 'flex';
        updateScores(0, 0, 0);
      }, 2000);
    });
    
    // Send message function for new interface
    function sendMessageNew() {
      const t = msgInputNew.value.trim();
      if (!t) return;
      
      addMessageNew(t, true);
      msgInputNew.value = '';
      
      messageCount++;
      
      // Calculate scores based on message count
      const eScore = Math.min(messageCount * 2, 9);
      const lScore = 5 + Math.min(messageCount, 4);
      const rScore = 6 + Math.min(messageCount, 3);
      
      updateScores(eScore, lScore, rScore);
      updateModeratorFeedback();
      
      if (!debateEnded) {
        setTimeout(() => {
          const r = opponentLines[Math.floor(Math.random() * opponentLines.length)];
          addMessageNew(r.text, false, r.evidence);
        }, 1500);
      }
    }
    
    // Add message to new interface
    function addMessageNew(t, isYou, evidence) {
      const d = document.createElement('div');
      d.className = 'msg ' + (isYou ? 'you' : 'opp');
      
      const n = document.createElement('strong');
      n.textContent = isYou ? 'You:' : 'LiteraryTitan:';
      d.appendChild(n);
      
      d.append(' ' + t);
      
      if (evidence) {
        const ev = document.createElement('div');
        ev.className = 'evidence';
        ev.textContent = evidence;
        d.appendChild(ev);
      }
      
      messagesNew.appendChild(d);
      messagesNew.scrollTop = messagesNew.scrollHeight;
    }
    
    // Event listeners for new interface
    sendBtnNew.addEventListener('click', sendMessageNew);
    msgInputNew.addEventListener('keydown', e => {
      if (e.key === 'Enter') sendMessageNew();
    });
    
    // Timer function that updates both timer displays
    function updateTimer() {
      timeLeft--;
      
      if (timeLeft <= 0) {
        clearInterval(ticking);
        endDebate();
        return;
      }
      
      const m = String(Math.floor(timeLeft / 60)).padStart(2, '0');
      const s = String(timeLeft % 60).padStart(2, '0');
      
      // Update both timer displays
      timerEl.textContent = `${m}:${s}`;
      timerElNew.textContent = `${m}:${s} remaining`;
      
      // Flash timer when time is running out
      if (timeLeft <= 30) {
        timerEl.style.color = timeLeft % 2 === 0 ? '#ff0000' : 'var(--secondary)';
        timerElNew.style.color = timeLeft % 2 === 0 ? '#ff0000' : 'inherit';
      }
    }
    
    // End debate function
    function endDebate() {
      debateEnded = true;
      msgInput.disabled = true;
      msgInputNew.disabled = true;
      sendBtn.disabled = true;
      sendBtnNew.disabled = true;
      
      // Add system message to both interfaces
      addMessage('Debate Time Ended', false);
      addMessageNew('Debate Time Ended', false);
      
      // Show feedback in the moderator panel
      aiPanel.querySelector('p').textContent = "Debate concluded! Your arguments showed good understanding of the text.";
    }
    
    // Original functions (kept for compatibility)
    function sendMessage() {
      const t = msgInput.value.trim();
      if (!t) return;
      
      const ev = evidenceInput.value.trim();
      addMessage(t, true, ev);
      
      msgInput.value = '';
      evidenceInput.value = '';
      
      messageCount++;
      
      const eScore = ev ? Math.min(messageCount * 2 + 2, 9) : Math.min(messageCount * 2, 7);
      const lScore = 5 + Math.min(messageCount, 4);
      const rScore = 6 + Math.min(messageCount, 3);
      
      updateScores(eScore, lScore, rScore);
      updateModeratorFeedback();
      
      if (!debateEnded) {
        setTimeout(() => {
          const r = opponentLines[Math.floor(Math.random() * opponentLines.length)];
          addMessage(r.text, false, r.evidence);
        }, 1500);
      }
    }
    
    function addMessage(t, isYou, evidence) {
      const d = document.createElement('div');
      d.className = 'msg ' + (isYou ? 'you' : 'opp');
      
      const n = document.createElement('strong');
      n.textContent = isYou ? 'You:' : 'LiteraryTitan:';
      d.appendChild(n);
      
      d.append(' ' + t);
      
      if (evidence) {
        const ev = document.createElement('div');
        ev.className = 'evidence';
        ev.textContent = evidence;
        d.appendChild(ev);
      }
      
      messages.appendChild(d);
      messages.scrollTop = messages.scrollHeight;
    }
    
    // Original event listeners
    sendBtn.addEventListener('click', sendMessage);
    msgInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') sendMessage();
    });
    
    // Update moderator feedback
    function updateModeratorFeedback() {
      const f = moderatorFeedback[Math.floor(Math.random() * moderatorFeedback.length)];
      aiPanel.querySelector('p').textContent = f;
    }
    
    // Update scores
    function updateScores(t, l, r) {
      const sCards = scorecards.querySelectorAll('.scorecard');
      
      sCards[0].querySelector('.score').textContent = t + '/10';
      sCards[0].querySelector('.score-comment').textContent = getComment(t);
      
      sCards[1].querySelector('.score').textContent = l + '/10';
      sCards[1].querySelector('.score-comment').textContent = getComment(l);
      
      sCards[2].querySelector('.score').textContent = r + '/10';
      sCards[2].querySelector('.score-comment').textContent = getComment(r);
    }
    
    function getComment(s) {
      if (s < 3) return 'Needs improvement';
      if (s < 6) return 'Developing';
      if (s < 8) return 'Strong';
      return 'Exceptional!';
    }
    
    // Mode tab click handler
    document.querySelectorAll('.mode-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        if (!this.classList.contains('active') && !this.parentElement.href) {
          alert('Demo limited to Debate Mode. Full application will include all modes.');
        }
      });
    });
    
    // Toggle between design modes (for testing)
    const toggleDesignBtn = document.createElement('button');
    toggleDesignBtn.textContent = 'Toggle Design';
    toggleDesignBtn.className = 'button';
    toggleDesignBtn.style.marginTop = '20px';
    toggleDesignBtn.style.display = 'none'; // Hidden by default, enable for testing
    
    toggleDesignBtn.addEventListener('click', function() {
      if (demoCard.style.display === 'none') {
        demoCard.style.display = 'block';
        newDebateInterface.style.display = 'none';
      } else {
        demoCard.style.display = 'none';
        newDebateInterface.style.display = 'block';
      }
    });
    
    document.querySelector('.container').appendChild(toggleDesignBtn);